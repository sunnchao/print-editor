# 打印模板在线编辑器

基于 Vue3 + Ant Design Vue 构建的打印模板设计工具

## 技术栈

- **框架**: Vue 3 (Composition API)
- **UI组件库**: Ant Design Vue 4.x
- **构建工具**: Vite
- **Excel解析**: xlsx (SheetJS)
- **拖拽功能**: vuedraggable / @vueuse/core

---

## 功能需求

### 1. 页面布局

采用经典的三栏式编辑器布局：

```
┌─────────────┬─────────────────────────┬─────────────┐
│             │                         │             │
│   左侧栏     │        中间画布          │   右侧栏    │
│   物料面板   │        预览区域          │   属性面板   │
│             │                         │             │
└─────────────┴─────────────────────────┴─────────────┘
```

#### 1.1 左侧 - 物料组件面板

预制的可拖拽物料组件列表：

| 组件类型 | 说明 |
|---------|------|
| 文本 | 静态文本/动态数据绑定文本 |
| 图片 | 支持上传或URL引用 |
| 表格 | 支持动态行数、合并单元格 |
| 条形码 | 根据数据源生成 |
| 二维码 | 根据数据源生成 |
| 线条 | 水平线/垂直线/分隔线 |
| 矩形框 | 边框容器 |

#### 1.2 中间 - 画布预览区

- **拖拽放置**: 从左侧拖入组件到画布
- **自由定位**: 组件可在画布内自由拖拽调整位置
- **尺寸调整**: 支持拖拽边角调整组件大小
- **右键菜单**: 
  - 通用操作: 复制、粘贴、删除、层级调整(置顶/置底)
  - 表格专属: 合并单元格、拆分单元格、插入行/列、删除行/列
- **对齐辅助**: 拖拽时显示对齐参考线
- **纸张设置**: 支持 A4/A5/自定义尺寸

#### 1.3 右侧 - 属性编辑面板

选中组件后显示对应的属性配置：

**通用属性:**
- 位置 (X, Y)
- 尺寸 (宽度, 高度)
- 边框样式
- 背景色

**文本组件属性:**
- 字体、字号、颜色
- 对齐方式
- 数据源绑定

**表格组件属性:**
- 行数、列数
- 单元格边框
- 表头设置
- 数据源绑定

---

### 2. 数据源功能

#### 2.1 Excel 文件上传

- 支持上传 `.xlsx` / `.xls` 格式文件
- 上传后解析并存储数据

#### 2.2 数据源解析规则

按**列**进行数据源划分：

```
Excel 示例:
┌─────────┬─────────┬─────────┐
│ 姓名    │ 部门     │ 工号    │  ← 第1行作为列标题
├─────────┼─────────┼─────────┤
│ 张三    │ 技术部   │ 001     │
│ 李四    │ 技术部   │ 002     │  ← 合并单元格情况
│ 王五    │ 销售部   │ 003     │
└─────────┴─────────┴─────────┘

解析后的数据源:
- 数据源A: "姓名" 列 → ["张三", "李四", "王五"]
- 数据源B: "部门" 列 → ["技术部", "技术部", "销售部"]  (合并单元格自动填充)
- 数据源C: "工号" 列 → ["001", "002", "003"]
```

#### 2.3 合并单元格处理

- **单值绑定**: 合并单元格作为单个值绑定到文本组件
- **表格数据源**: 合并单元格列可作为表格组件的数据源，保留合并信息用于渲染

#### 2.4 数据绑定

- 组件属性面板中提供"数据源"下拉选择
- 可选择具体的 Excel 列作为数据来源
- 支持预览绑定效果

---

### 3. 其他功能

- **模板保存/加载**: 导出为 JSON 格式，支持重新导入
- **打印预览**: 调用浏览器打印功能
- **撤销/重做**: 操作历史记录

---

## 项目结构（预览）

```
print-editor/
├── src/
│   ├── components/
│   │   ├── MaterialPanel/      # 左侧物料面板
│   │   ├── Canvas/             # 中间画布
│   │   ├── PropertyPanel/      # 右侧属性面板
│   │   └── widgets/            # 物料组件实现
│   │       ├── TextWidget.vue
│   │       ├── ImageWidget.vue
│   │       ├── TableWidget.vue
│   │       ├── BarcodeWidget.vue
│   │       └── ...
│   ├── stores/
│   │   ├── editor.ts           # 编辑器状态管理
│   │   └── datasource.ts       # 数据源管理
│   ├── utils/
│   │   └── excel.ts            # Excel 解析工具
│   └── App.vue
├── package.json
└── vite.config.ts
```

---

## 确认事项

请确认以下内容：

1. **物料组件类型**是否需要增减？
2. **右键菜单功能**是否需要补充？
3. **Excel数据源**的解析规则是否理解正确？
4. **其他功能**是否有遗漏？

确认无误后，我将开始编写代码。
